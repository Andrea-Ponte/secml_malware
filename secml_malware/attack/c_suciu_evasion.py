import numpy as np

from secml_malware.attack.c_kreuk_evasion import CKreukEvasion
from secml_malware.models import CClassifierEnd2EndMalware


class CSuciuEvasion(CKreukEvasion):
	def __init__(
			self,
			end2end_model: CClassifierEnd2EndMalware,
			how_many_padding_bytes : int,
			epsilon: float,
			is_debug: bool = False,
			threshold: float = 0.5,
			invalid_byte_value: int = -1
	):
		super(CSuciuEvasion, self).__init__(
			end2end_model=end2end_model,
			how_many_padding_bytes=how_many_padding_bytes,
			epsilon=epsilon,
			iterations=1,
			is_debug=is_debug,
			threshold=threshold,
			penalty_regularizer=0,
			invalid_byte_value=invalid_byte_value,
			p_norm=np.infty,
		)
